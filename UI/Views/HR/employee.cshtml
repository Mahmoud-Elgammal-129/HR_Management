@model BLL.AllEmployeeViewModel
@{
    ViewBag.Title = "employee";
}



<label class="form-control mt-5 title">الموظفين</label>
<form id="form">


    <div class="container">
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="row">
 
            <div class="column">
                <label class="form-control">البيانات الاساسية</label><br />

                <table>


                    <tr>
                        <td>اسم الموظف</td>
                        <td>
                            @*<input type="text" value="@Model.name" class="form-control" placeholder="اسم الموظف" id="txtname" />*@
                            @Html.EditorFor(model => model.name, new { htmlAttributes = new { @class = "form-control" } })

                            @Html.ValidationMessageFor(model => model.name, "", new { @class = "text-danger" })
                        </td>
                    </tr>

                    <tr>
                        <td> العنوان</td>
                        <td>
                            @*<input type="text" value="@Model.address" class="form-control" placeholder=" العنوان" id="txtaddres" />*@
                            @Html.EditorFor(model => model.address, new { htmlAttributes = new { @class = "form-control" } })

                            @Html.ValidationMessageFor(model => model.address, "", new { @class = "text-danger" })
                        </td>
                    </tr>

                    <tr>
                        <td> رقم تليفون</td>
                        <td>
                            @Html.EditorFor(model => model.phone, new { htmlAttributes = new { @class = "form-control" } })

                            @Html.ValidationMessageFor(model => model.phone, "", new { @class = "text-danger" })
                            @*<input type="text" value="@Model.phone" class="form-control" placeholder="رقم تليفون" id="txtphone" />*@
                        </td>
                    </tr>

                    <tr>
                        <td>النوع</td>
                        <td>
                            <select value="@Model.gender" data-val="true" 
                                    data-val-required="من فضلك حدد النوع"
                                     name="gender" class="form-control" id="genderid">
                                <option value="-1" selected disabled>Select Gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                            </select>
                            @Html.ValidationMessageFor(model => model.gender, "", new { @class = "text-danger" })

                        </td>

                    </tr>
                    <tr>
                        <td>القسم</td>
                        <td>
                            <select value="@Model.departmentID" class="form-control" id="departmentID"
                                    data-val="true" 
                                    data-val-required="The CreationDate field is required."
                                    name="departmentID">
                                <option value="-1" selected disabled>Select department</option>
                                @foreach (var item in ViewBag.departments)
                                {
                                    <option value="@item.id">@item.name</option>

                                }
                            </select>
                            @Html.ValidationMessageFor(model => model.departmentID, "", new { @class = "text-danger" })
                        </td>

                    </tr>
                    <tr>
                        <td>الجنسية</td>
                        <td>
                            @*<input type="text" value="@Model.national" class="form-control" placeholder="الجنسية" id="txtnational" />*@
                            @Html.EditorFor(model => model.national, new { htmlAttributes = new { @class = "form-control" } })

                            @Html.ValidationMessageFor(model => model.national, "", new { @class = "text-danger" })
                        </td>

                    </tr>
                    <tr>
                        <td>تاريخ الميلاد</td>
                        <td>
                            @Html.TextBoxFor(model => model.birthday, new { @type = "date",  @class = "form-control" })

                            @Html.ValidationMessageFor(model => model.birthday, "", new { @class = "text-danger" })
                            @*<input type="date" value="@Model.birthday" class="form-control" id="txtbirth" />*@
                        </td>


                    </tr>

                    <tr>
                        <td>الرقم القومى</td>
                        <td>
                            @*<input type="text" value="@Model.nationalID" class="form-control" placeholder="الرقم القومى" id="nationalid" />*@
                            @Html.EditorFor(model => model.nationalID, new { htmlAttributes = new { @class = "form-control" } })

                            @Html.ValidationMessageFor(model => model.nationalID, "", new { @class = "text-danger" })
                        </td>

                    </tr>


                </table>
            </div><br />
            <div class="column">
                <label class="form-control ">بيانات العمل</label><br />
                <table>


                    <tr>
                        <td> تاريخ التعاقد</td>
                        <td>
                            @*<input type="date" value="@Model.workDate" class="form-control" id="txtdate" />*@
                            @Html.TextBoxFor(model => model.workDate, new { @type = "date", @class = "form-control" })

                            @Html.ValidationMessageFor(model => model.workDate, "", new { @class = "text-danger" })
                        </td>

                    </tr>
                    <tr>
                        <td> الراتب</td>
                        <td>
                            @*<input type="text" value="@Model.sallery" class="form-control" placeholder=" الراتب" id="txtsallary"/>*@
                            @Html.EditorFor(model => model.sallery, new { htmlAttributes = new { @class = "form-control" } })

                            @Html.ValidationMessageFor(model => model.sallery, "", new { @class = "text-danger" })
                        </td>

                    </tr>
                    <tr>
                        <td> موعد الحضور</td>
                        <td>
                            <input type="time" value="@Model.attandanceDate" class="form-control"  id="attandanceDate" data-val="true" 
                                data-val-required="من فضلك ادخل موعد الحضور
."
                                name="attandanceDate" />
                            @Html.ValidationMessageFor(model => model.attandanceDate, "", new { @class = "text-danger" })
                        </td>

                    </tr>
                    <tr>
                        <td> موعد النصراف</td>
                        <td>
                            <input type="time" value="@Model.outDate" class="form-control" id="outDate" data-val="true" 
                                   data-val-required="من فضلك ادخل موعد الانصراف
."
                                   name="outDate" />
                            @Html.ValidationMessageFor(model => model.outDate, "", new { @class = "text-danger" })
                        </td>

                    </tr>
                </table>

            </div>
        </div>
        <br />
        <br />
        <br />
        <button class="btn btn-success" id="btnsave" style="margin-left:250px;">حفظ</button>
        <button class="btn btn-primary" id="btnupdate">تعديل</button>
        <button class="btn btn-danger" id="btncansel">حذف</button>

    </div>
</form>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
<script>
    $(document).ready(function () {


        $("#btnsave").click(function (event) {
            event.preventDefault();
   
            if ($('#form').valid()) {
                var empolyeePersonalDataViewModel = {
                    name: $('#name').val(),
                    address: $('#address').val(),
                    phone: $('#phone').val(),
                    gender: $('#genderid').val(),
                    national: $('#national').val(),
                    birthday: $('#birthday').val(),
                    nationalID: $('#nationalID').val(),
                    departmentID: $('#departmentID').val(),
                };

                var employeeWorkDataViewModel = {
                    workDate: $('#workDate').val(),
                    sallery: $('#sallery').val(),
                    attandanceDate: $('#attandanceDate').val(),
                    outDate: $('#outDate').val(),
                };



                var model = {
                    "empolyeePersonalDataViewModel": empolyeePersonalDataViewModel,
                    "employeeWorkDataViewModel": employeeWorkDataViewModel,
                };
                console.log(model);
                $.ajax({
                    url: "/HR/employee",
                    data: JSON.stringify(model),
                    type: "POST",
                    contentType: "application/json;charset=utf-8",
                    dataType: "json",
                    success: function (result) {
                        if (result == "success") {
                            alert("saved successfuly")
                            cleardata();
                        }

                    },
                    error: function (errormessage) {
                        alert(errormessage.responseText);
                    }
                });
            }
            cleardata();
        })


    });
    function cleardata() {

        $('#name').val('');
        $('#address').val('');
        $('#phone').val('');
        $('#genderid').val(-1);
        $('#national').val('');
        $('#birthday').val('');
        $('#nationalID').val('');
        $('#departmentID').val(-1);
        $('#workDate').val('');
        $('#sallery').val('');
        $('#attandanceDate').val('');
        $('#outDate').val('');
    }
</script>


